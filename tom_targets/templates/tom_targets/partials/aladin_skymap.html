<!-- embedding Aladin Lite example code found at: https://aladin.cds.unistra.fr/AladinLite/doc/  -->
<div id="aladin-lite-div" style="width:auto; height:700px; margin:auto; margin-top: 20px;" ></div>
<script type="text/javascript" src="https://aladin.cds.unistra.fr/AladinLite/api/v3/latest/aladin.js" charset="utf-8"></script>
<script type="text/javascript">

let aladin;
A.init.then(() => {
    aladin = A.aladin('#aladin-lite-div',
    {
    survey: "P/DSS2/color", 
    fov:360,
    projection:"MOL", 
    showReticle: false,
    showCooGrid: true,
    showCooGridControl: true,
    });
    
    aladin.setCooGrid({ color: 'grey', labelSize: 10 });
    
    var targets = {{ targets|safe }}; //targets cannot be a queryset; here it is a list of dictionaries

    for (var i = 0; i < targets.length; i++) {
        var target = targets[i];

        var dot_definition = {
            name: target.name,
            color: 'blue',
            sourceSize: 16};

        var cat = A.catalog(dot_definition);
        aladin.addCatalog(cat);
        popup_info = ['RA: '.concat(target.ra, '<br>',  'Dec: ', target.dec)];
        cat.addSources([A.marker(target.ra, target.dec, {popupTitle: target.name, popupDesc: popup_info})]);
    }

    const moonIllumination = {{ moon_illumination|safe }}.toFixed(3);
    const moonGreyscale = 255 * moonIllumination;

    // add catalog for the Moon
    const moonCatalog = A.catalog(
        {name: 'Moon',
        shape: 'circle',
        color: `rgb(${moonGreyscale}, ${moonGreyscale}, ${moonGreyscale})`,
        sourceSize: 26});

    const moonRaDeg = {{ moon_ra|safe }};
    const moonDecDeg = {{ moon_dec|safe }};

    const popupMoonDescription = `Illumination: ${moonIllumination} <br> RA: ${moonRaDeg.toFixed(4)} <br> Dec: ${moonDecDeg.toFixed(4)}`;

    moonCatalog.addSources([A.marker(moonRaDeg, moonDecDeg,
        {popupTitle: 'Geocentric Moon',
        popupDesc: popupMoonDescription
        })]);

    aladin.addCatalog(moonCatalog);

    });
</script>

